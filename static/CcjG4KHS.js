import{aq as B,az as b,r as C,R as S,a2 as U,S as T,a3 as $,O as j,as as E,c as x,j as F,N as H,ar as M,C as N,aA as p,aB as V,L as G,aC as I,b as K,B as L,ap as k}from"./TCJ18Cqp.js";function Q(a){return new URL(window.location.href)}const J=a=>a==="defer"||a===!1;function W(...a){var R;const n=typeof a[a.length-1]=="string"?a.pop():void 0;typeof a[0]!="string"&&a.unshift(n);let[s,o,t={}]=a;if(typeof s!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const e=B(),c=o,d=()=>b.value,y=()=>e.isHydrating?e.payload.data[s]:e.static.data[s];t.server=t.server??!0,t.default=t.default??d,t.getCachedData=t.getCachedData??y,t.lazy=t.lazy??!1,t.immediate=t.immediate??!0,t.deep=t.deep??b.deep,t.dedupe=t.dedupe??"cancel";const f=t.getCachedData(s,e),_=f!=null;if(!e._asyncData[s]||!t.immediate){(R=e.payload._errors)[s]??(R[s]=b.errorValue);const u=t.deep?C:S;e._asyncData[s]={data:u(_?f:t.default()),pending:C(!_),error:U(e.payload._errors,s),status:C("idle"),_default:t.default}}const r={...e._asyncData[s]};delete r._default,r.refresh=r.execute=(u={})=>{if(e._asyncDataPromises[s]){if(J(u.dedupe??t.dedupe))return e._asyncDataPromises[s];e._asyncDataPromises[s].cancelled=!0}if(u._initial||e.isHydrating&&u._initial!==!1){const l=u._initial?f:t.getCachedData(s,e);if(l!=null)return Promise.resolve(l)}r.pending.value=!0,r.status.value="pending";const h=new Promise((l,i)=>{try{l(c(e))}catch(g){i(g)}}).then(async l=>{if(h.cancelled)return e._asyncDataPromises[s];let i=l;t.transform&&(i=await t.transform(l)),t.pick&&(i=Y(i,t.pick)),e.payload.data[s]=i,r.data.value=i,r.error.value=b.errorValue,r.status.value="success"}).catch(l=>{if(h.cancelled)return e._asyncDataPromises[s];r.error.value=x(l),r.data.value=F(t.default()),r.status.value="error"}).finally(()=>{h.cancelled||(r.pending.value=!1,delete e._asyncDataPromises[s])});return e._asyncDataPromises[s]=h,e._asyncDataPromises[s]},r.clear=()=>X(e,s);const D=()=>r.refresh({_initial:!0}),v=t.server!==!1&&e.payload.serverRendered;{const u=H();if(u&&!u._nuxtOnBeforeMountCbs){u._nuxtOnBeforeMountCbs=[];const i=u._nuxtOnBeforeMountCbs;T(()=>{i.forEach(g=>{g()}),i.splice(0,i.length)}),$(()=>i.splice(0,i.length))}v&&e.isHydrating&&(r.error.value||f!=null)?(r.pending.value=!1,r.status.value=r.error.value?"error":"success"):u&&(e.payload.serverRendered&&e.isHydrating||t.lazy)&&t.immediate?u._nuxtOnBeforeMountCbs.push(D):t.immediate&&D();const h=M();if(t.watch){const i=j(t.watch,()=>r.refresh());h&&E(i)}const l=e.hook("app:data:refresh",async i=>{(!i||i.includes(s))&&await r.refresh()});h&&E(l)}const w=Promise.resolve(e._asyncDataPromises[s]).then(()=>r);return Object.assign(w,r),w}function X(a,n){n in a.payload.data&&(a.payload.data[n]=void 0),n in a.payload._errors&&(a.payload._errors[n]=b.errorValue),a._asyncData[n]&&(a._asyncData[n].data.value=void 0,a._asyncData[n].error.value=b.errorValue,a._asyncData[n].pending.value=!1,a._asyncData[n].status.value="idle"),n in a._asyncDataPromises&&(a._asyncDataPromises[n]&&(a._asyncDataPromises[n].cancelled=!0),a._asyncDataPromises[n]=void 0)}function Y(a,n){const s={};for(const o of n)s[o]=a[o];return s}function Z(a,n,s){const[o={},t]=typeof n=="string"?[{},n]:[n,s],e=N(()=>p(a)),c=o.key||V([t,typeof e.value=="string"?e.value:"",...A(o)]);if(!c||typeof c!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+c);if(!a)throw new Error("[nuxt] [useFetch] request is missing.");const d=c===t?"$f"+c:c;if(!o.baseURL&&typeof e.value=="string"&&e.value[0]==="/"&&e.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:y,lazy:f,default:_,transform:r,pick:D,watch:v,immediate:w,getCachedData:R,deep:u,dedupe:h,...l}=o,i=G({...I,...l,cache:typeof o.cache=="boolean"?void 0:o.cache}),g={server:y,lazy:f,default:_,transform:r,pick:D,immediate:w,getCachedData:R,deep:u,dedupe:h,watch:v===!1?[]:[i,e,...v||[]]};let m;return W(d,()=>{var O;(O=m==null?void 0:m.abort)==null||O.call(m,"Request aborted as another request to the same endpoint was initiated."),m=typeof AbortController<"u"?new AbortController:{};const P=p(o.timeout);let q;return P&&(q=setTimeout(()=>m.abort("Request aborted due to timeout."),P),m.signal.onabort=()=>clearTimeout(q)),(o.$fetch||globalThis.$fetch)(e.value,{signal:m.signal,...i}).finally(()=>{clearTimeout(q)})},g)}function A(a){var s;const n=[((s=p(a.method))==null?void 0:s.toUpperCase())||"GET",p(a.baseURL)];for(const o of[a.params||a.query]){const t=p(o);if(!t)continue;const e={};for(const[c,d]of Object.entries(t))e[p(c)]=p(d);n.push(e)}return n}function z(){const a=k(),{path:n}=K(),{protocol:s}=Q(),o=s=="https:";let e=(n.split("/")[1]||"").indexOf("en")>-1?"en":"es",c={maxAge:60*60*24*365*10,path:"/"};o&&(c.domain="."+a.public.baseReqDomain),L("req_uuid",c);const d=a.public.baseReqDomain;a.public.baseReqSecret,a.public.baseReqSignature;const y=L("user_p_timezone",c);let f={app:d||"lupacine.com",av:"1",dt:3,did:"",ch:"web",lan:e};return y.value=-(new Date().getTimezoneOffset()/60),y.value!=null&&(f.timezone=y.value),f.sign="51ed79b781c5c321171d33b034135665",f.did="LLfG2biPUh_8Nn2cvqz0G",f}const se=(a,n)=>{const s="https://svr.lupacine.com";let o={headers:{}};const t={key:n.key||a,baseURL:s,timeout:15e3,onRequest({options:e,request:c}){let d=z();e.body&&(e.body.language="es-mx",e.body.base=d)},onRequestError({error:e}){},onResponse({response:e}){+e.status==200&&+e._data.code!=0&&alert(e._data.msg)},onResponseError({error:e}){}};return Z(a,{...t,...o,...n},"$SQlhB7w0w2").catch(e=>{})},ne=(a,n)=>{const s="https://svr.lupacine.com";let o={headers:{}};const t={baseURL:s,onRequest({options:e,request:c}){let d=z();e.body?(e.body.language="es-mx",e.body.base=d):e.body={base:d}},onResponse({response:e}){+e.status==200&&+e._data.code!=0&&alert(e._data.msg)},onResponseError(){alert("Ocurrió un error. Inténtalo de nuevo más tarde.")}};return $fetch(a,{...t,...o,...n})};export{ne as a,Q as b,se as u};
